webpackJsonp([2],{129:function(t,e,i){i(257),i(258);var n=i(60)(i(183),i(293),"data-v-4ff7552c",null);t.exports=n.exports},152:function(t,e,i){"use strict";i.d(e,"C",function(){return r}),i.d(e,"D",function(){return o}),i.d(e,"y",function(){return s}),i.d(e,"a",function(){return c}),i.d(e,"z",function(){return l}),i.d(e,"A",function(){return u}),i.d(e,"x",function(){return d}),i.d(e,"s",function(){return _}),i.d(e,"w",function(){return p}),i.d(e,"l",function(){return f}),i.d(e,"t",function(){return m}),i.d(e,"u",function(){return h}),i.d(e,"j",function(){return v}),i.d(e,"v",function(){return g}),i.d(e,"k",function(){return b}),i.d(e,"m",function(){return y}),i.d(e,"o",function(){return x}),i.d(e,"p",function(){return w}),i.d(e,"q",function(){return S}),i.d(e,"n",function(){return k}),i.d(e,"r",function(){return P}),i.d(e,"E",function(){return C}),i.d(e,"i",function(){return O}),i.d(e,"e",function(){return T}),i.d(e,"b",function(){return A}),i.d(e,"d",function(){return z}),i.d(e,"f",function(){return E}),i.d(e,"g",function(){return $}),i.d(e,"c",function(){return F}),i.d(e,"h",function(){return q}),i.d(e,"B",function(){return V});var n=i(61),a=(i(35),i(59)),r=function(t){return i.i(n.a)("/guanmei/config/index",t,"POST").then(a.d)},o=function(t){return i.i(n.a)("/guanmei/config/edit",t,"POST").then(a.d)},s=function(t){return i.i(n.a)("/guanmei/admin_user/index",t,"POST").then(a.d)},c=function(t){return i.i(n.a)("/guanmei/admin_user/edit",t,"POST").then(a.d)},l=function(t){return i.i(n.a)("/guanmei/admin_user/verify",t,"POST").then(a.d)},u=function(t){return i.i(n.a)("/guanmei/admin_user/del",t,"POST").then(a.d)},d=function(t){return i.i(n.a)("/guanmei/admin_user/info",t,"POST").then(a.d)},_=function(t){return i.i(n.a)("/guanmei/admin_group/index",t,"POST").then(a.d)},p=function(t){return i.i(n.a)("/guanmei/admin_group/all_list",t,"POST").then(a.d)},f=function(t){return i.i(n.a)("/guanmei/admin_group/edit",t,"POST").then(a.d)},m=function(t){return i.i(n.a)("/guanmei/admin_group/verify",t,"POST").then(a.d)},h=function(t){return i.i(n.a)("/guanmei/admin_group/del",t,"POST").then(a.d)},v=function(t){return i.i(n.a)("/guanmei/admin_group/info",t,"POST").then(a.d)},g=function(t){return i.i(n.a)("/guanmei/admin_group/sort",t,"POST").then(a.d)},b=function(t){return i.i(n.a)("/guanmei/admin_purview/tree",t,"POST").then(a.d)},y=function(t){return i.i(n.a)("/guanmei/admin_purview/all_list",t,"POST").then(a.d)},x=function(t){return i.i(n.a)("/guanmei/admin_purview/edit",t,"POST").then(a.d)},w=function(t){return i.i(n.a)("/guanmei/admin_purview/verify",t,"POST").then(a.d)},S=function(t){return i.i(n.a)("/guanmei/admin_purview/del",t,"POST").then(a.d)},k=function(t){return i.i(n.a)("/guanmei/admin_purview/info",t,"POST").then(a.d)},P=function(t){return i.i(n.a)("/guanmei/admin_purview/sort",t,"POST").then(a.d)},C=function(t){return i.i(n.a)("/guanmei/admin_purview/get_menu",t,"POST").then(a.d)},O=function(t){return i.i(n.a)("/guanmei/admin_log/index",t,"POST").then(a.d)},T=function(t){return i.i(n.a)("/guanmei/admin_orgnize/tree",t,"POST").then(a.d)},A=function(t){return i.i(n.a)("/guanmei/admin_orgnize/all_list",t,"POST").then(a.d)},z=function(t){return i.i(n.a)("/guanmei/admin_orgnize/edit",t,"POST").then(a.d)},E=function(t){return i.i(n.a)("/guanmei/admin_orgnize/verify",t,"POST").then(a.d)},$=function(t){return i.i(n.a)("/guanmei/admin_orgnize/del",t,"POST").then(a.d)},F=function(t){return i.i(n.a)("/guanmei/admin_orgnize/info",t,"POST").then(a.d)},q=function(t){return i.i(n.a)("/guanmei/admin_orgnize/sort",t,"POST").then(a.d)},V=function(t){return i.i(n.a)("/guanmei/admin/del_app_login_token",t,"POST")}},153:function(t,e,i){t.exports={default:i(155),__esModule:!0}},154:function(t,e,i){"use strict";e.__esModule=!0;var n=i(153),a=function(t){return t&&t.__esModule?t:{default:t}}(n);e.default=a.default||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t}},155:function(t,e,i){i(157),t.exports=i(2).Object.assign},156:function(t,e,i){"use strict";var n=i(15),a=i(36),r=i(22),o=i(37),s=i(65),c=Object.assign;t.exports=!c||i(11)(function(){var t={},e={},i=Symbol(),n="abcdefghijklmnopqrst";return t[i]=7,n.split("").forEach(function(t){e[t]=t}),7!=c({},t)[i]||Object.keys(c({},e)).join("")!=n})?function(t,e){for(var i=o(t),c=arguments.length,l=1,u=a.f,d=r.f;c>l;)for(var _,p=s(arguments[l++]),f=u?n(p).concat(u(p)):n(p),m=f.length,h=0;m>h;)d.call(p,_=f[h++])&&(i[_]=p[_]);return i}:c},157:function(t,e,i){var n=i(9);n(n.S+n.F,"Object",{assign:i(156)})},158:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(64),a=i.n(n),r=i(63),o=i.n(r),s=i(154),c=i.n(s),l=(i(62),i(152)),u=i(38),d=i(66),_=i(59),p=i(161),f=i.n(p);e.default={data:function(){return{baseImgPath:u.b,avatar:f.a,user_info:"",dialogFormVisible:!1,password:""}},created:function(){this.adminInfo.id,this.user_info=JSON.parse(i.i(_.a)("user_info"))},computed:c()({},i.i(d.b)(["adminInfo"])),methods:c()({},i.i(d.c)(["getAdminData"]),{handleCommand:function(t){var e=this;return o()(a.a.mark(function n(){return a.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:"home"==t?e.$router.push("/manage"):"singout"==t?(i.i(_.e)("token"),e.$message({type:"success",message:"退出成功"}),e.$router.push("/")):"show_edit_password"==t&&(e.dialogFormVisible=!0,e.password="");case 1:case"end":return n.stop()}},n,e)}))()},edit_password:function(){i.i(l.a)({id:this.user_info.id,password:this.password}).then(function(t){t.code==this.$store.state.constant.status_success?(this.$message({message:t.msg,type:"success"}),this.dialogFormVisible=!1):this.$message({message:t.msg,type:"warning"})}.bind(this))}})}},159:function(t,e,i){e=t.exports=i(117)(!1),e.push([t.i,".allcover{position:absolute;top:0;right:0}.ctt{left:50%;transform:translate(-50%,-50%)}.ctt,.tb{position:absolute;top:50%}.tb{transform:translateY(-50%)}.lr{position:absolute;left:50%;transform:translateX(-50%)}.header_container{background-color:#eff2f7;height:60px;display:-ms-flexbox;display:flex;-ms-flex-pack:justify;justify-content:space-between;-ms-flex-align:center;align-items:center;padding-left:20px}.avator{width:36px;height:36px;border-radius:50%;margin-right:37px}.el-dropdown-menu__item{text-align:center}",""])},160:function(t,e,i){var n=i(159);"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);i(118)("49988b78",n,!0)},161:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAEvElEQVRYR+2WbVBUVRjH/+feZZddWFgWWDbCoFBeR94MccZ0GCmnGsKwwB0JB3UaXhqSMm2GRmWUmkwLiimxwpBmbIMmAXXKMcvJQHwhBXnZhnDQVQQEXGRZdmHvnuZuwqDswvJFv/B8u3Of8z+/+T/Pc84heMxBHvP+mAd4FA4oWKnnQa+o52Oki2KFsmcT1Jdyot+ZKP2jAPg6anf1Kq9liYGmji50HStCYObuwjPJnjt4iBkBqEoZAIaVkSO3rthqVt0beTEWhpXIKz79y14zuwSEqaMLT6yzcOMQuntDd/5PGA23/9F8nhViE4D2RLgQZfMI/5NmyGTWpHKdztYGwym53maWdfFQF3fZA3By86p4rqwj/d7NFgjFHtBrroBIxeeb97y2bBoA7VgogkkYCZYRkNCWehuiUQB4qCEAbQBMEzm0PSSAhGomQWjFewqyYX8fAJXPitcz/VXb4scG+9D9y2FLZEHVklOridXVaSWg7SFBkDjdIf5X704BWOckQIFcxorCFzkbFiuFMku/RVLXZeRkIpwLYE1pZbWhCSS4vdrqXNl233EG24QbP5lothBpYMxmz+gXpObU/Pybqe6DjjYhC+CHiGCR7x/fPx0hkwqkk1A6DpZ6E4416FFy6d7Y1li3pMTKvpNzPdgmHQiuoVJ21LK+TcUevC/CAFDvyVN45mcqVtkUphS4Zsa1X/VY//MdfPmifOPSQz3lc4F4oAThlTSsNZXwteUjOz5WvPx0RWCaXUEeYJyCVo3iwi0jPmsYslStlQWQD7u1jkLYHUMnAZqHGsOVIiHxnk2M1owAwxRvnxyAKkJSvfJQb/Jsa6b1AFUt8CVqbff9H9FxkZKP69XPrHZIaIyC/jSC+hsmnNWOmvNX6kSkAJaH19LWcFcwXDAJ1TTaAFAGEHXPxBip3s3wTNz3/hP27X9IndYaMNBrRv7vd/Hty3Jf8tH129aJ2PFUODQ3NKQKHNUE+4I6xZDQluOzTcGbe7Z4x+Vn+Wy2ilCKrF3d2LddCTdXfjCmBz1ugHGAw6bafvy4Vr6QFGo7HXHPXg8kvxIvXV59wH+rVcQIlB4dQFqSDFKX/wH+vW7CuSsGpK/xsH7TqhFc7zOj5OIQilaIXcn+XutpOls8AEArc1xJ6ld6AL5iZ6ZYfzksBaDAVQZYTDFqtEDszE8n0NJhRM1v9/BBtgLQcaAnjChvGoaAoCOjtj+IzwlVc1sYhjk1ZbKm8cx0GZ1tPBrYHxUifnVi1c6iHlSqdSgtWYD4pS7ATQB+AG0wAZ1mvHSkB98lyTf6Fd+yngXhlVTemkomTz1bbswEkMAw+GKoMcxL4swo+MUcR1H3twFxkWKIhIwVgArMwGkTyi4Pg6OWtuylg4ttTYC9Usz2Hsh1l7IbtGeCPFwkbOC0sdKOA3UmlF4YxoCJ69wZK19C9l7jLyqHYzYAXmgTAXalr5FpC/MU/k8qhX58zceaxtB00YC9DUMmpYQ5fOCiPtPhXackOgLAp/sDyAEQ7ewENx83gUw/yumHjbRyzIJvAEy9OefE4SjAnETnkjwPMNWBtwCkAMgFwHd83lystJHL3ysFAPgzIQNA8f3nXPzU3PkSzDvwH1iQrTBfEt9eAAAAAElFTkSuQmCC"},162:function(t,e,i){i(160);var n=i(60)(i(158),i(163),null,null);t.exports=n.exports},163:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"header_container"},[i("el-breadcrumb",{attrs:{separator:"/"}},[i("el-breadcrumb-item",{attrs:{to:{path:"/manage"}}},[t._v("首页")]),t._v(" "),t._l(t.$route.meta,function(e,n){return i("el-breadcrumb-item",{key:e},[t._v(t._s(e))])})],2),t._v(" "),i("el-dropdown",{attrs:{"menu-align":"start"},on:{command:t.handleCommand}},[i("p",{staticStyle:{height:"50px","line-height":"50px","text-align":"center","margin-right":"20px",cursor:"pointer"}},[i("i",{staticClass:"iconfont"},[t._v("")]),t._v(t._s(t.user_info.show_name))]),t._v(" "),i("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[i("el-dropdown-item",{attrs:{command:"show_edit_password"}},[t._v("修改密码")]),t._v(" "),i("el-dropdown-item",{attrs:{command:"singout"}},[t._v("退出")])],1)],1),t._v(" "),i("el-dialog",{attrs:{title:"修改密码",visible:t.dialogFormVisible,width:"30%"},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[i("el-form",[i("el-form-item",{attrs:{label:"密码"}},[i("el-input",{attrs:{"auto-complete":"off"},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}})],1)],1),t._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("取 消")]),t._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:t.edit_password}},[t._v("确 定")])],1)],1)],1)},staticRenderFns:[]}},164:function(t,e,i){"use strict";i.d(e,"c",function(){return r}),i.d(e,"b",function(){return o}),i.d(e,"e",function(){return s}),i.d(e,"f",function(){return c}),i.d(e,"a",function(){return l}),i.d(e,"g",function(){return u}),i.d(e,"d",function(){return d}),i.d(e,"i",function(){return _}),i.d(e,"h",function(){return p}),i.d(e,"l",function(){return f}),i.d(e,"k",function(){return m}),i.d(e,"j",function(){return h});var n=i(61),a=(i(35),i(59)),r=function(t){return i.i(n.a)("/guanmei/produce_order/index",t,"POST").then(a.d)},o=function(t){return i.i(n.a)("/guanmei/produce_order/edit",t,"POST").then(a.d)},s=function(t){return i.i(n.a)("/guanmei/produce_order/verify",t,"POST").then(a.d)},c=function(t){return i.i(n.a)("/guanmei/produce_order/del",t,"POST").then(a.d)},l=function(t){return i.i(n.a)("/guanmei/produce_order/info",t,"POST").then(a.d)},u=function(t){return i.i(n.a)("/guanmei/produce_order/sort",t,"POST").then(a.d)},d=function(t){return i.i(n.a)("/guanmei/produce_order/submit_storage",t,"POST").then(a.d)},_=function(t){return i.i(n.a)("/guanmei/produce_order/storage_produce_order_list",t,"POST").then(a.d)},p=function(t){return i.i(n.a)("/guanmei/produce_order/gen_barcode_html",t,"POST").then(a.d)},f=function(t){return i.i(n.a)("/guanmei/produce_order/process_produce_order",t,"POST").then(a.d)},m=function(t){return i.i(n.a)("/guanmei/produce_order/handover",t,"POST").then(a.d)},h=function(t){return i.i(n.a)("/guanmei/produce_order/detail",t,"POST").then(a.d)}},169:function(t,e,i){"use strict";i.d(e,"d",function(){return r}),i.d(e,"c",function(){return o}),i.d(e,"e",function(){return s}),i.d(e,"f",function(){return c}),i.d(e,"a",function(){return l}),i.d(e,"g",function(){return u}),i.d(e,"b",function(){return d}),i.d(e,"h",function(){return _});var n=i(61),a=(i(35),i(59)),r=function(t){return i.i(n.a)("/guanmei/sales_order/index",t,"POST").then(a.d)},o=function(t){return i.i(n.a)("/guanmei/sales_order/edit",t,"POST").then(a.d)},s=function(t){return i.i(n.a)("/guanmei/sales_order/verify",t,"POST").then(a.d)},c=function(t){return i.i(n.a)("/guanmei/sales_order/del",t,"POST").then(a.d)},l=function(t){return i.i(n.a)("/guanmei/sales_order/info",t,"POST").then(a.d)},u=function(t){return i.i(n.a)("/guanmei/sales_order/sort",t,"POST").then(a.d)},d=function(t){return i.i(n.a)("/guanmei/sales_order/init_select_options",t,"POST").then(a.d)},_=function(t){return i.i(n.a)("/guanmei/sales_order_sub/index",t,"POST").then(a.d)}},183:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(23),a=i.n(n),r=i(162),o=i.n(r),s=i(164),c=i(169),l=i(59);e.default={data:function(){return{id:0,tableData:[],table_loading:!1,limit:20,count:0,currentPage:1,loading:!1,active:0,way:-1,multipleSelection:{},upload_url:this.$store.state.constant.upload_url,dialogImageUrl:"",dialogVisible:!1,order_date:"",delivery_date:"",produce_man:"",sub_orders:[],file_list:[],img_upload_limit:3,options:{},material_sub_froms:[{id:1,name:"厂内"},{id:2,name:"客户自带"}],success_orders:[]}},components:{headTop:o.a},created:function(){this.user_info=JSON.parse(i.i(l.a)("user_info"))},mounted:function(){},beforeRouteEnter:function(t,e,i){i(function(e){e.id=t.query.id?t.query.id:0,e.is_new=t.query.is_new?t.query.is_new:0,e.way=t.query.way?parseInt(t.query.way):-1,e.active=t.query.active?parseInt(t.query.active):0,e.init_select_options().then(function(){e.id&&e.id>0?e.get_info():e.init()})})},beforeRouteUpdate:function(t,e,n){if(this.way=t.query.way?parseInt(t.query.way):-1,this.active=t.query.active?parseInt(t.query.active):0,0==this.active&&1==this.way&&this.get_sales_sub_order_list(),1==this.active&&1==this.way){var a=JSON.parse(i.i(l.a)("cache_sales_order_selection"));a||(this.$message({message:"请选择业务订单",type:"warning"}),this.$router.replace({path:"add_produce_order",query:{active:0,way:1}})),this.sub_orders=a,this.gen_options_product_cat_product()}n()},methods:{init:function(){if(this.loading=!1,this.active=this.active?this.active:0,this.way=this.way?this.way:-1,1==this.active&&1==this.way){var t=JSON.parse(i.i(l.a)("cache_sales_order_selection"));t||(this.$message({message:"请选择业务订单",type:"warning"}),this.$router.replace({path:"add_produce_order",query:{active:0,way:1}})),this.sub_orders=t,this.gen_options_product_cat_product()}0==this.active&&1==this.way&&this.get_sales_sub_order_list(),0==this.active&&-1==this.way&&this.is_new&&(this.multipleSelection={},i.i(l.b)("cache_sales_order_selection",""),this.order_date="",this.delivery_date="",this.produce_man="",this.sub_orders=[],this.handleCurrentChange(1)),this.produce_man=this.user_info.show_name},get_sales_sub_order_list:function(){this.table_loading=!0,i.i(c.h)({page:this.currentPage,page_size:this.limit,status:1}).then(function(t){t.code==this.$store.state.constant.status_success?(this.tableData=t.data.list,this.count=parseInt(t.data.count),setTimeout(function(){this.toggleSelection(this.multipleSelection["page"+this.currentPage])}.bind(this))):this.$message({message:t.msg,type:"warning"}),this.table_loading=!1}.bind(this))},go_make:function(){var t;for(var e in this.multipleSelection)t||(t={}),this.multipleSelection[e]&&this.multipleSelection[e].length&&this.multipleSelection[e].forEach(function(e){var i=e.product_cat_id+"|"+e.product_id+"|"+e.color_id+"|"+e.color_code;t[i]||(t[i]={});var n=e.color_id+"|"+e.color_code;t[i][n]||(t[i][n]={order_codes:[],order_sub_ids:[],order_sub:[],data:{}}),-1==t[i][n].order_sub_ids.indexOf(e.id)&&(t[i][n].order_sub_ids.push(e.id),t[i][n].order_sub.push({sub_id:e.id,order_id:e.order_id})),-1==t[i][n].order_codes.indexOf(e.sales_order.order_no)&&t[i][n].order_codes.push(e.sales_order.order_no),t[i][n].data.product_id?t[i][n].data.sum=parseInt(t[i][n].data.sum)+parseInt(e.sum):t[i][n].data=e});if(!t)return void this.$message({message:"请选择订单进行下一步操作",type:"warning"});var n=[];for(e in t){var a={};for(var r in t[e])a.product_id?a.colors.push({color:{id:t[e][r].data.color_id,name:t[e][r].data.color_code},id:t[e][r].data.color_id,name:t[e][r].data.color_code,sum:t[e][r].data.sum,order_codes:t[e][r].order_codes,order_sub:t[e][r].order_sub}):(a=t[e][r].data,a.material_sub=[],a.colors=[{color:{id:a.color_id,name:a.color_code},id:a.color_id,name:a.color_code,sum:a.sum,order_codes:t[e][r].order_codes,order_sub:t[e][r].order_sub}]);n.push(a)}i.i(l.b)("cache_sales_order_selection",n),this.$router.push({path:"add_produce_order",query:{active:1,way:1}})},check_is_same_orders:function(){var t=!0,e="";for(var i in this.multipleSelection)if(this.multipleSelection[i]&&this.multipleSelection[i].length&&this.multipleSelection[i].forEach(function(i){if(e){var n=i.product_cat_id+"|"+i.product_id+"|"+i.color_id+"|"+i.color_code;if(e!=n)return void(t=!1)}else e=i.product_cat_id+"|"+i.product_id+"|"+i.color_id+"|"+i.color_code}),!t)break;return t},handleCurrentChange:function(t){this.currentPage=t,this.get_sales_sub_order_list()},handleSelectionChange:function(t){setTimeout(function(){this.multipleSelection["page"+this.currentPage]=t}.bind(this))},toggleSelection:function(t){var e=this;t&&t.forEach(function(t){e.tableData.forEach(function(i){i.id==t.id&&e.$refs.multipleTable.toggleRowSelection(i,!0)})})},get_info:function(){i.i(s.a)({id:this.id}).then(function(t){t.code==this.$store.state.constant.status_success?(this.order_date=t.data.order_date,this.delivery_date=t.data.delivery_date,this.produce_man=t.data.produce_man,this.sub_orders=t.data.sales_order_sub,this.gen_options_product_cat_product()):this.$message({message:t.msg,type:"warning"})}.bind(this))},submit:function(){var t={id:this.id,order_date:this.order_date,delivery_date:this.delivery_date,produce_man:this.produce_man,sub_orders:this.sub_orders},e="";t.order_date||(e="请填写制单日期"),t.delivery_date||(e="请填写交货日期"),t.produce_man||(e="请填写生产统筹员姓名"),(!t.sub_orders||t.sub_orders.length<1)&&(e="请添加订单子项");var n=0;if(t.sub_orders.forEach(function(t,i){t.material&&t.material.length||(e="第"+(i+1)+"个子项,请选择材料"),t.material.forEach(function(t){t.material.id&&t.sum||(e="第"+(i+1)+"个子项,请检查材料是否设置完整")}),t.process&&t.process.length||(e="第"+(i+1)+"个子项,请选择流程"),t.product_cat_id||(e="第"+(i+1)+"个子项,请选择帽型类别"),t.product_id||(e="第"+(i+1)+"个子项,请选择帽型型号"),t.colors&&t.colors.length?t.colors.forEach(function(t){n++,t.id&&t.name&&t.sum||(e="第"+(i+1)+"个子项,请检查颜色是否设置完整")}):e="第"+(i+1)+"个子项,请添加颜色";var a=[];t.sample_imgs&&t.sample_imgs.length>0&&t.sample_imgs.forEach(function(t){a.push(t.url)}),t.sample_imgs_final=a}.bind(this)),e)return void this.$message({type:"warning",message:e});if(t.id)var a="确认无误, 是否继续?";else var a="确认无误, 将会生产"+n+"个订单, 是否继续?";this.$confirm(a,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){this.loading=!0,i.i(s.b)(t).then(function(e){e.code==this.$store.state.constant.status_success?(this.$message({message:e.msg,type:"success"}),t.id?this.$router.replace({path:"produce_order"}):(this.success_orders=e.data,this.active=2)):this.$message({message:e.msg,type:"warning"})}.bind(this))}.bind(this)).catch(function(){}).finally(function(){this.loading=!1}.bind(this))},init_select_options:function(){return i.i(c.b)().then(function(t){return new a.a(function(e,i){t.code==this.$store.state.constant.status_success?(this.options=t.data,this.options.options_color.push({id:"-1",name:"其他"})):this.$message({message:t.msg,type:"warning"}),e()}.bind(this))}.bind(this))},handleRemove:function(t,e,i){this.sub_orders[i].sample_imgs=e},handlePictureCardPreview:function(t){this.dialogImageUrl=t.url,this.dialogVisible=!0},handleAvatarSuccess:function(t,e,i,n){if(i){var a=!0,r=[];i.forEach(function(t){"success"==t.status?t.response&&t.response.data&&t.response.data[0]?r.push({name:"",url:t.response.data[0]}):t.url&&r.push({name:"",url:t.url}):a=!1}.bind(this)),a&&(n.sample_imgs=r)}},beforeAvatarUpload:function(t){return i.i(l.c)(t,this)},handleExceed:function(){this.$message({message:"最多上传3张图片哦",type:"warning"})},add_block:function(){var t={product_cat:{},product:{},colors:[{color:{id:"",name:""},id:"",name:"",sum:""}],material:[],decoration:"",material_sub:[],process:[],sample_imgs:[],sample_info:""};this.sub_orders.push(t)},del_block:function(t){this.sub_orders.splice(t,1)},add_color:function(t){var e={id:"",name:"",sum:"",color:{}};this.sub_orders[t].colors.push(e)},del_color:function(t,e){this.sub_orders[t].colors.splice(e,1)},add_material:function(t){var e={material:"",sum:""};this.sub_orders[t].material.push(e)},del_material:function(t,e){this.sub_orders[t].material.splice(e,1)},add_material_sub:function(t){var e={material:"",from:"",sum:""};this.sub_orders[t].material_sub.push(e)},del_material_sub:function(t,e){this.sub_orders[t].material_sub.splice(e,1)},change_product_cat:function(t){t.product_cat_id=t.product_cat.id,t.product_cat_name=t.product_cat.name,t.options_product_cat_product=[],t.product={},this.options.options_product.forEach(function(e){e.cid==t.product_cat.id&&(t.options_product_cat_product=e.options,t.product=e.options&&e.options.length?e.options[0]:{},this.change_product(t))}.bind(this))},gen_options_product_cat_product:function(){this.sub_orders.forEach(function(t){this.options.options_product.forEach(function(e){e.cid==t.product_cat.id&&(t.options_product_cat_product=e.options)}.bind(this))}.bind(this))},change_product:function(t){t.product_id=t.product.id,t.product_name=t.product.name},change_color:function(t){t.id=t.color.id,t.name=t.color.name},change_process:function(t){var e=function(t,e){var i=parseInt(t.sort),n=parseInt(e.sort);return i>n?-1:i<n?1:0};t.process=t.process.sort(e)}}}},219:function(t,e,i){e=t.exports=i(117)(!1),e.push([t.i,".avatar-uploader{display:inline-block;vertical-align:middle}.hide_plus .el-upload{display:none}",""])},220:function(t,e,i){e=t.exports=i(117)(!1),e.push([t.i,".allcover[data-v-4ff7552c]{position:absolute;top:0;right:0}.ctt[data-v-4ff7552c]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)}.tb[data-v-4ff7552c]{position:absolute;top:50%;transform:translateY(-50%)}.lr[data-v-4ff7552c]{position:absolute;left:50%;transform:translateX(-50%)}.search_item[data-v-4ff7552c]{margin-top:10px}.pre_info[data-v-4ff7552c]{display:inline-block;width:140px}.block[data-v-4ff7552c]{margin:10px 0;padding:10px;padding-top:0;border:1px dashed #aaa;width:800px;position:relative}.more_btn[data-v-4ff7552c]{font-size:12px;border-radius:20px;padding:5px;width:120px;text-align:center}.del_block[data-v-4ff7552c]{position:absolute;top:10px;right:10px;color:red;cursor:pointer}.del_block[data-v-4ff7552c]:hover{color:#c86464}.add_block[data-v-4ff7552c]{border:1px dashed #333;font-size:12px;width:800px;text-align:center;padding:10px;cursor:pointer;background:#fafaff}.add_block[data-v-4ff7552c]:hover{border-color:#409eff;color:#409eff}.demo-table-expand .el-form-item[data-v-4ff7552c]{margin-right:0;margin-bottom:0;width:45%}",""])},257:function(t,e,i){var n=i(219);"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);i(118)("2cd576a2",n,!0)},258:function(t,e,i){var n=i(220);"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);i(118)("c568cc08",n,!0)},293:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"fillcontain"},[i("head-top"),t._v(" "),i("div",{staticClass:"table_container",staticStyle:{padding:"20px"}},[t.id?t._e():i("el-steps",{staticStyle:{"margin-bottom":"20px"},attrs:{active:t.active,"align-center":"","finish-status":"success"}},[i("el-step",{attrs:{title:"选择方式"}}),t._v(" "),i("el-step",{attrs:{title:"填写生产单信息"}}),t._v(" "),i("el-step",{attrs:{title:"完成"}})],1),t._v(" "),0==t.active&&-1==t.way?i("div",{staticStyle:{display:"block",margin:"100px auto","text-align":"center"}},[i("el-button",{staticStyle:{margin:"20px auto",display:"inline-block",width:"150px",height:"150px"},attrs:{type:"success"},on:{click:function(e){t.$router.push({path:"add_produce_order",query:{active:0,way:1}})}}},[t._v("选择业务单制单")]),t._v(" "),i("el-button",{staticStyle:{margin:"20px auto","margin-left":"50px",display:"inline-block",width:"150px",height:"150px"},attrs:{type:"success"},on:{click:function(e){t.$router.push({path:"add_produce_order",query:{active:1,way:2}})}}},[t._v("直接制单")])],1):t._e(),t._v(" "),0==t.active&&1==t.way?i("div",{staticClass:"table_container"},[i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.table_loading,expression:"table_loading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:t.tableData},on:{"selection-change":t.handleSelectionChange}},[i("el-table-column",{attrs:{type:"selection",width:"55"}}),t._v(" "),i("el-table-column",{attrs:{type:"expand"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-form",{staticClass:"demo-table-expand",attrs:{"label-position":"left",inline:""}},[i("el-form-item",{attrs:{label:"材质:"}},t._l(e.row.material,function(e,n){return i("span",[t._v(t._s(e.name)+";")])})),t._v(" "),i("el-form-item",{attrs:{label:"装饰说明:"}},[i("span",[t._v(t._s(e.row.decoration))])]),t._v(" "),i("el-form-item",{attrs:{label:"样品图:"}},t._l(e.row.sample_imgs_final,function(t,e){return i("img",{attrs:{width:"80",src:t}})})),t._v(" "),i("el-form-item",{attrs:{label:"样品说明:"}},[i("span",[t._v(t._s(e.row.sample_info))])]),t._v(" "),i("el-form-item",{attrs:{label:"流程:"}},t._l(e.row.process,function(e,n){return i("span",[0!=n?i("span",[t._v("->")]):t._e(),t._v(t._s(e.name))])}))],1)]}}])}),t._v(" "),i("el-table-column",{attrs:{label:"帽型",prop:"product_cat_name"}}),t._v(" "),i("el-table-column",{attrs:{label:"型号",prop:"product_code"}}),t._v(" "),i("el-table-column",{attrs:{label:"颜色",prop:"color_code"}}),t._v(" "),i("el-table-column",{attrs:{label:"数量",prop:"sum"}}),t._v(" "),i("el-table-column",{attrs:{label:"业务单号",prop:"sales_order.order_no"}}),t._v(" "),i("el-table-column",{attrs:{label:"制单时间",prop:"sales_order.order_date"}})],1),t._v(" "),i("div",{staticClass:"Pagination",staticStyle:{"text-align":"left","margin-top":"10px"}},[i("el-pagination",{attrs:{"current-page":t.currentPage,"page-size":t.limit,layout:"total, prev, pager, next",total:t.count,background:""},on:{"current-change":t.handleCurrentChange}})],1)],1):t._e(),t._v(" "),1==t.active?i("div",{staticClass:"table_container"},[i("div",{staticClass:"search_item"},[t._m(0),t._v(" "),i("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"选择日期"},model:{value:t.order_date,callback:function(e){t.order_date=e},expression:"order_date"}})],1),t._v(" "),i("div",{staticClass:"search_item"},[t._m(1),t._v(" "),i("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"选择日期"},model:{value:t.delivery_date,callback:function(e){t.delivery_date=e},expression:"delivery_date"}})],1),t._v(" "),i("div",{staticClass:"search_item"},[t._m(2),t._v(" "),i("el-input",{staticStyle:{width:"350px"},attrs:{clearable:"",placeholder:"请输入生产统筹员姓名"},model:{value:t.produce_man,callback:function(e){t.produce_man=e},expression:"produce_man"}})],1),t._v(" "),t._l(t.sub_orders,function(e,n){return i("div",{staticClass:"block"},[i("div",{staticClass:"search_item"},[t._m(3,!0),t._v(" "),i("el-select",{attrs:{disabled:2!=t.way,placeholder:"请选择","value-key":"id"},on:{change:function(i){t.change_product_cat(e)}},model:{value:e.product_cat,callback:function(i){t.$set(e,"product_cat",i)},expression:"sub_order.product_cat"}},t._l(t.options.options_product_cat,function(t){return i("el-option",{key:t.id,attrs:{label:t.name,value:t}})})),t._v(" "),i("el-select",{attrs:{disabled:2!=t.way,placeholder:"请选择","value-key":"id"},on:{change:function(i){t.change_product(e)}},model:{value:e.product,callback:function(i){t.$set(e,"product",i)},expression:"sub_order.product"}},t._l(e.options_product_cat_product,function(t){return i("el-option",{key:t.id,attrs:{label:t.name,value:t}})}))],1),t._v(" "),i("div",{staticClass:"search_item"},[t._m(4,!0),t._v(" "),i("div",{staticStyle:{display:"inline-block","vertical-align":"top"}},t._l(e.colors,function(e,n){return i("div",{staticStyle:{"margin-bottom":"3px"}},[i("el-select",{attrs:{disabled:2!=t.way,placeholder:"请选择","value-key":"id"},on:{change:function(i){t.change_color(e)}},model:{value:e.color,callback:function(i){t.$set(e,"color",i)},expression:"color.color"}},t._l(t.options.options_color,function(t){return i("el-option",{key:t.id,attrs:{label:t.name,value:t}})})),t._v(" "),-1==e.id?i("el-input",{staticStyle:{width:"120px"},attrs:{disabled:2!=t.way,clearable:"",placeholder:"颜色"},model:{value:e.name,callback:function(i){t.$set(e,"name",i)},expression:"color.name"}}):t._e(),t._v(" "),i("el-input",{staticStyle:{width:"120px"},attrs:{disabled:2!=t.way,clearable:"",placeholder:"数量",type:"number"},model:{value:e.sum,callback:function(i){t.$set(e,"sum",i)},expression:"color.sum"}}),t._v(" "),e.order_codes?i("el-tooltip",{attrs:{placement:"top"}},[i("div",{attrs:{slot:"content"},slot:"content"},[t._v("\n                                    包含业务订单:"),i("br"),t._v(" "),t._l(e.order_codes,function(e,n){return i("p",[t._v(t._s(e))])})],2),t._v(" "),i("i",{staticClass:"iconfont"},[t._v("")])]):t._e()],1)}))]),t._v(" "),i("div",{staticClass:"search_item"},[t._m(5,!0),t._v(" "),i("div",{staticStyle:{display:"inline-block","vertical-align":"top"}},[t._l(e.material,function(e,a){return i("div",{staticStyle:{"margin-bottom":"3px"}},[i("el-select",{attrs:{"value-key":"id",placeholder:"请选择材料"},model:{value:e.material,callback:function(i){t.$set(e,"material",i)},expression:"material.material"}},t._l(t.options.options_material,function(t){return i("el-option",{key:t.id,attrs:{label:t.name,value:t}})})),t._v(" "),i("el-input",{staticStyle:{width:"120px"},attrs:{clearable:"",placeholder:"数量"},model:{value:e.sum,callback:function(i){t.$set(e,"sum",i)},expression:"material.sum"}}),t._v(" "),i("el-button",{attrs:{type:"danger",round:"",size:"mini"},on:{click:function(e){t.del_material(n,a)}}},[t._v("删除")])],1)}),t._v(" "),i("el-button",{attrs:{type:"danger",round:"",size:"mini"},on:{click:function(e){t.add_material(n)}}},[i("i",{staticClass:"iconfont",staticStyle:{"font-size":"10px"}},[t._v("")]),t._v("添加更多材料")])],2)]),t._v(" "),i("div",{staticClass:"search_item"},[t._m(6,!0),t._v(" "),i("el-select",{attrs:{multiple:"",placeholder:"请选择","value-key":"id"},on:{change:function(i){t.change_process(e)}},model:{value:e.process,callback:function(i){t.$set(e,"process",i)},expression:"sub_order.process"}},t._l(t.options.options_process,function(t){return i("el-option",{key:t.id,attrs:{label:t.name,value:t}})}))],1),t._v(" "),i("div",{staticClass:"search_item"},[i("span",{staticClass:"pre_info",staticStyle:{"font-size":"14px"}},[t._v("装饰说明:")]),t._v(" "),i("el-input",{staticStyle:{width:"350px","vertical-align":"middle"},attrs:{type:"textarea",clearable:"",placeholder:"请输入装饰说明"},model:{value:e.decoration,callback:function(i){t.$set(e,"decoration",i)},expression:"sub_order.decoration"}})],1),t._v(" "),i("div",{staticClass:"search_item"},[i("span",{staticClass:"pre_info",staticStyle:{"font-size":"14px"}},[t._v("装饰\\辅料:")]),t._v(" "),i("div",{staticStyle:{display:"inline-block","vertical-align":"top"}},[t._l(e.material_sub,function(e,a){return i("div",{staticStyle:{"margin-bottom":"3px"}},[i("el-select",{attrs:{"value-key":"id",placeholder:"请选择装饰/辅料"},model:{value:e.material,callback:function(i){t.$set(e,"material",i)},expression:"material_sub.material"}},t._l(t.options.options_material_sub,function(t){return i("el-option",{key:t.id,attrs:{label:t.name,value:t}})})),t._v(" "),i("el-select",{attrs:{"value-key":"id",placeholder:"请选择来源"},model:{value:e.from,callback:function(i){t.$set(e,"from",i)},expression:"material_sub.from"}},t._l(t.material_sub_froms,function(t){return i("el-option",{key:t.id,attrs:{label:t.name,value:t}})})),t._v(" "),i("el-input",{staticStyle:{width:"120px"},attrs:{clearable:"",placeholder:"数量"},model:{value:e.sum,callback:function(i){t.$set(e,"sum",i)},expression:"material_sub.sum"}}),t._v(" "),i("el-button",{attrs:{type:"danger",round:"",size:"mini"},on:{click:function(e){t.del_material_sub(n,a)}}},[t._v("删除")])],1)}),t._v(" "),i("el-button",{attrs:{type:"danger",round:"",size:"mini"},on:{click:function(e){t.add_material_sub(n)}}},[i("i",{staticClass:"iconfont",staticStyle:{"font-size":"10px"}},[t._v("")]),t._v("添加更多辅料")])],2)]),t._v(" "),i("div",{staticClass:"search_item"},[i("span",{staticClass:"pre_info",staticStyle:{"font-size":"14px"}},[t._v("样品图片:")]),t._v(" "),i("el-upload",{staticClass:"avatar-uploader",class:!e.sample_imgs||e.sample_imgs.length<t.img_upload_limit?"show_plus":"hide_plus",attrs:{action:t.upload_url,multiple:"","list-type":"picture-card","file-list":e.sample_imgs,"on-success":function(i,n,a){return t.handleAvatarSuccess(i,n,a,e)},"before-upload":t.beforeAvatarUpload,"on-preview":t.handlePictureCardPreview,"on-exceed":t.handleExceed,limit:t.img_upload_limit,"on-remove":function(e,i){return t.handleRemove(e,i,n)}}},[i("i",{staticClass:"el-icon-plus"})]),t._v(" "),i("el-dialog",{attrs:{visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e}}},[i("img",{attrs:{width:"100%",src:t.dialogImageUrl,alt:""}})])],1),t._v(" "),i("div",{staticClass:"search_item"},[i("span",{staticClass:"pre_info",staticStyle:{"font-size":"14px"}},[t._v("样品说明:")]),t._v(" "),i("el-input",{staticStyle:{width:"350px","vertical-align":"middle"},attrs:{type:"textarea",clearable:"",placeholder:"请输入样品说明"},model:{value:e.sample_info,callback:function(i){t.$set(e,"sample_info",i)},expression:"sub_order.sample_info"}})],1),t._v(" "),2==t.way?i("i",{staticClass:"iconfont del_block",on:{click:function(e){t.del_block(n)}}},[t._v("")]):t._e(),t._v(" "),i("el-badge",{staticClass:"mark",staticStyle:{position:"absolute",bottom:"0",right:"0"},attrs:{value:n+1}})],1)}),t._v(" "),2==t.way?i("div",{staticClass:"search_item add_block",on:{click:t.add_block}},[i("i",{staticClass:"iconfont",staticStyle:{"font-size":"10px"}},[t._v("")]),t._v("增加订单子项")]):t._e()],2):t._e(),t._v(" "),2==t.active?i("div",{staticClass:"table_container",staticStyle:{"text-align":"center"}},[i("p",[t._v("已成功生成如下订单:")]),t._v(" "),t._l(t.success_orders,function(e,n){return i("p",[t._v(t._s(e.order_no))])})],2):t._e(),t._v(" "),0==t.active&&1==t.way?i("el-button",{staticStyle:{margin:"20px auto",display:"flex"},attrs:{type:"success",loading:t.loading},on:{click:t.go_make}},[t._v("下一步")]):t._e(),t._v(" "),1==t.active?i("el-button",{staticStyle:{margin:"20px auto",display:"flex"},attrs:{type:"success",loading:t.loading},on:{click:t.submit}},[t._v("提交")]):t._e(),t._v(" "),2==t.active?i("el-button",{staticStyle:{margin:"20px auto",display:"flex"},attrs:{type:"success",loading:t.loading},on:{click:function(e){t.$router.replace({path:"produce_order"})}}},[t._v("返回列表")]):t._e()],1)],1)},staticRenderFns:[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("span",{staticClass:"pre_info",staticStyle:{"font-size":"14px"}},[i("i",{staticStyle:{color:"red"}},[t._v("*")]),t._v("制单日期:")])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("span",{staticClass:"pre_info",staticStyle:{"font-size":"14px"}},[i("i",{staticStyle:{color:"red"}},[t._v("*")]),t._v("交货日期:")])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("span",{staticClass:"pre_info",staticStyle:{"font-size":"14px"}},[i("i",{staticStyle:{color:"red"}},[t._v("*")]),t._v("生产统筹员:")])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("span",{staticClass:"pre_info",staticStyle:{"font-size":"14px"}},[i("i",{staticStyle:{color:"red"}},[t._v("*")]),t._v("帽型:")])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("span",{staticClass:"pre_info",staticStyle:{"font-size":"14px"}},[i("i",{staticStyle:{color:"red"}},[t._v("*")]),t._v("颜色:")])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("span",{staticClass:"pre_info",staticStyle:{"font-size":"14px"}},[i("i",{staticStyle:{color:"red"}},[t._v("*")]),t._v("材料:")])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("span",{staticClass:"pre_info",staticStyle:{"font-size":"14px"}},[i("i",{staticStyle:{color:"red"}},[t._v("*")]),t._v("流程:")])}]}}});